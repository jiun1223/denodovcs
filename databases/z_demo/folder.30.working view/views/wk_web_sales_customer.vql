CREATE OR REPLACE VIEW wk_web_sales_customer FOLDER = '/30.working view' DESCRIPTION = '跨兩資料源
SQL web_sales + Oracle customer'  AS SELECT bv_sql_web_sales_all.ws_sold_date_sk AS ws_sold_date_sk, bv_sql_web_sales_all.ws_sold_time_sk AS ws_sold_time_sk, bv_sql_web_sales_all.ws_ship_date_sk AS ws_ship_date_sk, bv_sql_web_sales_all.ws_item_sk AS ws_item_sk, bv_sql_web_sales_all.ws_bill_customer_sk AS ws_bill_customer_sk, bv_sql_web_sales_all.ws_bill_cdemo_sk AS ws_bill_cdemo_sk, bv_sql_web_sales_all.ws_bill_hdemo_sk AS ws_bill_hdemo_sk, bv_sql_web_sales_all.ws_bill_addr_sk AS ws_bill_addr_sk, bv_sql_web_sales_all.ws_ship_customer_sk AS ws_ship_customer_sk, bv_sql_web_sales_all.ws_ship_cdemo_sk AS ws_ship_cdemo_sk, bv_sql_web_sales_all.ws_ship_hdemo_sk AS ws_ship_hdemo_sk, bv_sql_web_sales_all.ws_ship_addr_sk AS ws_ship_addr_sk, bv_sql_web_sales_all.ws_web_page_sk AS ws_web_page_sk, bv_sql_web_sales_all.ws_web_site_sk AS ws_web_site_sk, bv_sql_web_sales_all.ws_ship_mode_sk AS ws_ship_mode_sk, bv_sql_web_sales_all.ws_warehouse_sk AS ws_warehouse_sk, bv_sql_web_sales_all.ws_promo_sk AS ws_promo_sk, bv_sql_web_sales_all.ws_order_number AS ws_order_number, bv_sql_web_sales_all.ws_quantity AS ws_quantity, bv_sql_web_sales_all.ws_wholesale_cost AS ws_wholesale_cost, bv_sql_web_sales_all.ws_list_price AS ws_list_price, bv_sql_web_sales_all.ws_sales_price AS ws_sales_price, bv_sql_web_sales_all.ws_ext_discount_amt AS ws_ext_discount_amt, bv_sql_web_sales_all.ws_ext_sales_price AS ws_ext_sales_price, bv_sql_web_sales_all.ws_ext_wholesale_cost AS ws_ext_wholesale_cost, bv_sql_web_sales_all.ws_ext_list_price AS ws_ext_list_price, bv_sql_web_sales_all.ws_ext_tax AS ws_ext_tax, bv_sql_web_sales_all.ws_coupon_amt AS ws_coupon_amt, bv_sql_web_sales_all.ws_ext_ship_cost AS ws_ext_ship_cost, bv_sql_web_sales_all.ws_net_paid AS ws_net_paid, bv_sql_web_sales_all.ws_net_paid_inc_tax AS ws_net_paid_inc_tax, bv_sql_web_sales_all.ws_net_paid_inc_ship AS ws_net_paid_inc_ship, bv_sql_web_sales_all.ws_net_paid_inc_ship_tax AS ws_net_paid_inc_ship_tax, bv_sql_web_sales_all.ws_net_profit AS ws_net_profit, "bv_oracle_CUSTOMER"."C_CUSTOMER_SK" AS "C_CUSTOMER_SK", "bv_oracle_CUSTOMER"."C_CUSTOMER_ID" AS "C_CUSTOMER_ID", "bv_oracle_CUSTOMER"."C_CURRENT_CDEMO_SK" AS "C_CURRENT_CDEMO_SK", "bv_oracle_CUSTOMER"."C_CURRENT_HDEMO_SK" AS "C_CURRENT_HDEMO_SK", "bv_oracle_CUSTOMER"."C_CURRENT_ADDR_SK" AS "C_CURRENT_ADDR_SK", "bv_oracle_CUSTOMER"."C_FIRST_SHIPTO_DATE_SK" AS "C_FIRST_SHIPTO_DATE_SK", "bv_oracle_CUSTOMER"."C_FIRST_SALES_DATE_SK" AS "C_FIRST_SALES_DATE_SK", "bv_oracle_CUSTOMER"."C_SALUTATION" AS "C_SALUTATION", "bv_oracle_CUSTOMER"."C_FIRST_NAME" AS "C_FIRST_NAME", "bv_oracle_CUSTOMER"."C_LAST_NAME" AS "C_LAST_NAME", "bv_oracle_CUSTOMER"."C_PREFERRED_CUST_FLAG" AS "C_PREFERRED_CUST_FLAG", "bv_oracle_CUSTOMER"."C_BIRTH_DAY" AS "C_BIRTH_DAY", "bv_oracle_CUSTOMER"."C_BIRTH_MONTH" AS "C_BIRTH_MONTH", "bv_oracle_CUSTOMER"."C_BIRTH_YEAR" AS "C_BIRTH_YEAR", "bv_oracle_CUSTOMER"."C_BIRTH_COUNTRY" AS "C_BIRTH_COUNTRY", "bv_oracle_CUSTOMER"."C_LOGIN" AS "C_LOGIN", "bv_oracle_CUSTOMER"."C_EMAIL_ADDRESS" AS "C_EMAIL_ADDRESS", "bv_oracle_CUSTOMER"."C_LAST_REVIEW_DATE" AS "C_LAST_REVIEW_DATE" FROM bv_sql_web_sales_all AS bv_sql_web_sales_all INNER JOIN bv_oracle_customer AS "bv_oracle_CUSTOMER" ON bv_sql_web_sales_all.ws_ship_customer_sk = "bv_oracle_CUSTOMER"."C_CUSTOMER_SK"  CONTEXT ('I18N' = 'us_cst');

ALTER VIEW wk_web_sales_customer
 LAYOUT (bv_sql_web_sales_all = [70, 50, 200, 225], bv_oracle_customer = [420, 40, 300, 300]);

ALTER VIEW wk_web_sales_customer
 DELEGATESTATSQUERY = true GET_TABLE_STATS = true ATSOURCE_THROUGH_VDP_ONLY;

